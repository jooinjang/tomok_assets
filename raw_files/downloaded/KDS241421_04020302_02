{"cells":[{"cell_type":"markdown","metadata":{"id":"-0-qnEblh80w"},"source":["# Rule Unit 작성 예시\n","\n","본 문서는 1차년도 6월에 개발된 RuleUnit 클래스를 활용하여 룰 유닛을 작성하고 실행하는 과정을 설명합니다."]},{"cell_type":"markdown","metadata":{"id":"AR83L9Pxh_6F"},"source":["⚠︎ 주의사항: 코드를 변경하며 작업할 때는, 사본을 생성한 후 작업해주십시오."]},{"cell_type":"markdown","metadata":{"id":"33RPd0N_iCuY"},"source":["## 룰 유닛 작성하기\n","이 부분에서는 기존의 IFC 파일에 종속적이었던 실행 흐름에서 벗어나, 새로이 정의한 RuleUnit 구조에 기반하여 룰에 포함된 항목을 작성하는 방법을 다룹니다.<br><br>\n","본 예시에서는 KDS 24 14 21 4.6.5.1(5) 를 룰 유닛으로 작성합니다."]},{"cell_type":"markdown","metadata":{"id":"qL08gaStiE0L"},"source":["먼저, Rule 작성에 필요한 프로그램을 불러오기 위해 Github에서 아래의 주소가 가리키는 파일 모음을 불러옵니다. (Github Repository를 clone합니다.)"]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5AR_68PDk-KZ","executionInfo":{"status":"ok","timestamp":1701252343785,"user_tz":-540,"elapsed":2288,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}},"outputId":"4ea2b025-336f-4dd0-bb41-c291189aeae8"},"outputs":[{"output_type":"stream","name":"stdout","text":["Cloning into 'tomok'...\n","remote: Enumerating objects: 212, done.\u001b[K\n","remote: Counting objects: 100% (154/154), done.\u001b[K\n","remote: Compressing objects: 100% (113/113), done.\u001b[K\n","remote: Total 212 (delta 75), reused 107 (delta 41), pack-reused 58\u001b[K\n","Receiving objects: 100% (212/212), 15.75 MiB | 17.05 MiB/s, done.\n","Resolving deltas: 100% (83/83), done.\n"]}],"source":["!git clone https://github.com/KU-HIAI/tomok.git"]},{"cell_type":"markdown","metadata":{"id":"poob594xiNFU"},"source":["필요한 파일을 불러온 다음에는 현재 작업 경로를 tomok의 파일이 있는 위치로 이동합니다.<br><br>\n","아래의 코드 블록을 실행하면, 작성자의 기본 작업 경로가 필요한 파일이 있는 위치로 이동됩니다."]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qyIxAqkriO26","executionInfo":{"status":"ok","timestamp":1701252343785,"user_tz":-540,"elapsed":8,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}},"outputId":"3ae76225-02e4-4936-c78d-1027fe66b93d"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/tomok\n"]}],"source":["cd tomok"]},{"cell_type":"markdown","metadata":{"id":"8lGDCXNZiej5"},"source":["## 룰 유닛 작성해보기\n","지금까지의 내용을 바탕으로 룰 유닛을 작성해봅시다.\n","\n","새로운 룰 유닛을 작성하기 위해서는, 아래 코드 블럭에서 클래스 이름, 메타정보에 해당하는 변수, 실행 함수의 이름과 내용을 수정하면 됩니다."]},{"cell_type":"code","execution_count":3,"metadata":{"id":"rfDi2pQqicoD","executionInfo":{"status":"ok","timestamp":1701252343785,"user_tz":-540,"elapsed":7,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}}},"outputs":[],"source":["import math\n","from typing import List\n","\n","import tomok\n","\n","# 작성하는 룰에 맞게 클래스 이름 수정 (KDS241421_04020302_02)\n","class KDS241421_04020302_02 (tomok.RuleUnit):\n","\n","    # 아래 클래스 멤버 변수에 할당되는 값들을 작성하는 룰에 맞게 수정\n","    priority = 1   # 건설기준 우선순위\n","    author = 'Chanwoo Yang'  # 작성자명\n","    ref_code = 'KDS 24 14 21 4.2.3.2 (2)' # 건설기준문서\n","    ref_date = '2021-04-12'  # 디지털 건설문서 작성일\n","    doc_date = '2023-11-12'  # 건설기준문서->디지털 건설기준 변환 기준일\n","    title = '콘크리트 인장 영역 내의 소요 최소 철근량'    # 건설기준명\n","\n","    #\n","    description = \"\"\"\n","    콘크리트교 설계기준 (한계상태설계법)\n","    4. 설계\n","    4.2 사용한계상태\n","    4.2.3 균열\n","    4.2.3.2 최소철근량\n","    (2)\n","    \"\"\"\n","    # https://dillinger.io/ 표와 이미지 랜더링 확인 사이트\n","    # 이미지 링크 변환 사이트 https://www.somanet.xyz/2017/06/blog-post_21.html\n","    # 건설기준문서내용(text)\n","    content = \"\"\"\n","\n","\n","    \"\"\"\n","    # 플로우차트(mermaid)\n","    flowchart = \"\"\"\n","    flowchart TD\n","    subgraph Python_Class\n","    A[\"콘크리트 인장 영역 내의 소요 최소 철근량\"];\n","    B[\"KDS 24 14 21 4.2.3.2 (2)\"];\n","    A ~~~ B\n","    end\n","\t\tsubgraph Variable_def;\n","\t\tVarIn1[/입력변수: 첫 균열 발생 직전 상태에서 계산된 콘크리트의인장영역단면적/];\n","\t\tVarIn2[/입력변수: 첫 균열 발생 직후에 허용하는 철근의 인장응력/];\n","\t\tVarIn3[/입력변수: 첫 균열이 발생할 때 유효한 콘크리트 인장강도/];\n","\t\tVarIn4[/입력변수: 균열 발생 직전의 단면 내 응력 분포 상태를 반영하는계수/];\n","\t\tVarIn5[/입력변수: 단면에 작용하는 평균 법선응력/];\n","\t\tVarIn6[/입력변수: 단면에 작용하는 축력/];\n","\t\tVarIn7[/입력변수: 단면 기준 깊이/];\n","\t\tVarIn8[/입력변수: 단면 깊이/];\n","\t\tVarIn9[/입력변수: 축력이 응력 분포에 미치는 영향을 반영하는 계수/];\n","\t\tVarIn10[/입력변수: 플랜지에 균열이 처음 발생하기 직전에 부재전단면에작용하는휨모멘트와축력으로계산한플랜지의인장력/];\n","\t\tVarIn11[/입력변수: 간접하중영향에 의해 부등 분포하는 응력의영향을반영하는계수/];\n","\t\tVarIn12[/입력변수: 복부폭을 포함한 플랜지 너비/];\n","\t\tVarOut1[/출력변수: 콘크리트 인장 영역 내의 소요 최소 철근량/]\n","\t\tVarOut1~~~VarIn1 & VarIn2 & VarIn3 & VarIn4\n","\t\tVarIn2~~~ VarIn5 & VarIn6 & VarIn7 & VarIn8\n","\t\tVarIn5~~~ VarIn9 & VarIn10 & VarIn11 & VarIn12\n","\t\tend\n","\t\tPython_Class ~~~ Variable_def;\n","\t\tVariable_def--->F\n","\t\tC{\"축력이 응력 분포에 미치는 영향을 반영하는 계수\"}\n","\t\tC--축력Nu가 압축력일때--->D\n","\t\tD[\"철근의 인장응력≤<img src='https://latex.codecogs.com/svg.image?k_1=1.5'>---------------------------------\"]\n","\t\tC--축력Nu가 인장력일때--->E\n","\t\tE[\"프리스트레스 강재의 응력≤<img src='https://latex.codecogs.com/svg.image?2h^*/3h'>---------------------------------\"]\n","\t\tF{단면 기준 깊이}\n","\t\tG[\"<img src='https://latex.codecogs.com/svg.image?h^*=h'>---------------------------------\"]\n","\t\tH[\"<img src='https://latex.codecogs.com/svg.image?h^*=1.0m'>---------------------------------\"]\n","\t\tF--h<1.0일때--->G\n","\t\tF--h≥1.0일때--->H\n","\t\tG & H--->C\n","\t\tI{\"Kc=균열 발생 직전의 단면 내 응력 분포 상태를 반영하는 계수\"}\n","\t\tD -->I\n","\t\tJ[\"<img src='https://latex.codecogs.com/svg.image?K_c=1.0'>---------------------------------\"]\n","\t\tK[\"<img src='https://latex.codecogs.com/svg.image?0.4[1-\\frac{f_n}{k(h/h^*)f_{ct}}]\\leq&space;1'>---------------------------------\"]\n","\t\tL[\"<img src='https://latex.codecogs.com/svg.image?0.9\\frac{N_{cr}}{A_{ct}f_{ct}}\\geq&space;0.5'>---------------------------------\"]\n","\t\tI--순수인장을 받는 경우--->J\n","\t\tI--휨과 축력을 받는 부재 복부--->K\n","\t\tI--박스형이나 T형 단면 부재 플랜지--->L\n","\n","\t\tP{\"k= 간접하중영향에 의해 부등 분포하는 응력의 영향을 반영하는 계수\"}\n","\t\tM[\"1.0\"]\n","\t\tN[\"0.65\"]\n","\t\tO[\"사이 값 보간\"]\n","\t\tVariable_def--->P\n","\t\tP--면 깊이 또는 복부 폭을 포함한 플랜지 너비가 300mm 이하일 경우--->M\n","\t\tP--단편 깊이 또는 복부 폭을 포함한 플랜지 너비가 800mm 이상일 경우--->N\n","\t\tP--단편 깊이 또는 복부 폭을 포함한 플랜지 너비가 800mm 이상일 경우--->O\n","\t\tE[\"<img src='https://latex.codecogs.com/svg.image?A_{s,min}=k_ckA_{ct}\\frac{f_{ct}}{f_s}'>---------------------------------\"]\n","\t\tM & N & O & J & K & L--->E\n","\t\tE--->Z\n","\t\tZ([\"콘크리트 인장 영역 내의 소요 최소 철근량\"])\n","    \"\"\"\n","\n","    # 작성하는 룰에 맞게 함수 이름과 내용을 수정,\n","    @tomok.rule_method\n","    def Minimum_amount_of_rebar_required_within_concrete_tensile_area(fOAsmin,fIAct,fIfs,fIfct,fIkc,fIfn,fINu,fIhstar,fIk1,fINcr,fIk,fIh,fIflawid,fIuserdefined) -> float:\n","        \"\"\"콘크리트 인장 영역 내의 소요 최소 철근량\n","\n","        Args:\n","             fOAsmin (float): 콘크리트 인장 영역 내의 소요 최소 철근량\n","             fIAct (float): 첫 균열 발생 직전 상태에서 계산된 콘크리트의 인장 영역 단면적\n","             fIfs (float): 첫 균열 발생 직후에 허용하는 철근의 인장응력\n","             fIfct (float): 첫 균열이 발생할 때 유효한 콘크리트 인장강도\n","             fIkc (float): 균열 발생 직전의 단면 내 응력 분포 상태를 반영하는 계수\n","             fIfn (float): 단면에 작용하는 평균 법선응력\n","             fINu (float): 단면에 작용하는 축력\n","             fIhstar (float): 단면 기준 깊이\n","             fIk1 (float): 축력이 응력 분포에 미치는 영향을 반영하는 계수\n","             fINcr (float): 플랜지에 균열이 처음 발생하기 직전에 부재 전단면에 작용하는 휨모멘트와 축력으로 계산한 플랜지의 인장력\n","             fIk (float): 간접하중영향에 의해 부등 분포하는 응력의 영향을 반영하는 계수\n","             fIh (float): 단면 깊이\n","             fIflawid (float): 복부폭을 포함한 플랜지 너비\n","             fIuserdefined (float): 사용자 선택\n","\n","\n","\n","        Returns:\n","            float: 콘크리트교 설계기준 (한계상태설계법) 4.2.3.2 최소철근량 (2)의 값\n","        \"\"\"\n","\n","        if fIh < 1000:\n","          fIhstar = fIh\n","        else:\n","          fIhstar = 1000\n","\n","        if fINu >= 0:\n","          fIk1 = 1.5\n","        else:\n","          fIk1 = 2 * fIhstar / ( 3 * fIh)\n","\n","        if min(fIh, fIflawid) <= 300:\n","          fIk = 1.0\n","        elif max(fIh, fIflawid) >= 800:\n","          fIk = 0.65\n","        else:\n","          fIk = ((1.0-0.65)/(300-800)) * (fIflawid - 300) + 1.0\n","\n","        # 순수인장을 받는 경우: fIuserdefined =1\n","        # 휨과 축력을 받는 부재 복부: fIuserdefined = 2\n","        # 박스형이나 T형 단면 부재 플랜지: fIuserdefined = 3\n","        if fIuserdefined == 1:\n","          fIkc = 1.0\n","        elif fIuserdefined == 2:\n","          fIkc = min(0.4 * ( 1 - fIfn/(fIk1 * fIh / fIhstar * fIfct)), 1)\n","        elif fIuserdefined == 3:\n","          fIkc = max(0.9 * fINcr / ( fIAct * fIfct ), 0.5)\n","\n","        fOAsmin = fIkc * fIk * fIAct * fIfct / fIfs\n","\n","        return fOAsmin"]},{"cell_type":"markdown","source":[],"metadata":{"id":"yVE_Q1rB2KwO"}},{"cell_type":"markdown","metadata":{"id":"9oy-Y8abiiIu"},"source":["작성한 룰 유닛은 아래의 코드 블럭과 같이 생성하여, 작성자가 임의로 검증을 수행할 수 있습니다."]},{"cell_type":"code","execution_count":4,"metadata":{"id":"D1Pm_gEtikei","executionInfo":{"status":"ok","timestamp":1701252343786,"user_tz":-540,"elapsed":8,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}}},"outputs":[],"source":["my_RuleUnit = KDS241421_04020302_02()"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"HVyDu2z7imJC","executionInfo":{"status":"ok","timestamp":1701252343786,"user_tz":-540,"elapsed":8,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}}},"outputs":[],"source":["fOAsmin = None\n","fIAct = 128030\n","fIfs = 400\n","fIfct = 3.45\n","fIkc = None\n","fIfn = 0\n","fINu = 0\n","fIh = 500\n","fIhstar = None\n","fIk1 = None\n","fINcr = None\n","fIk = None\n","fIflawid = 500\n","fIuserdefined = 2"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"UDa_8Sh_iraQ","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1701252343786,"user_tz":-540,"elapsed":7,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}},"outputId":"db918024-80aa-4021-dd74-0da789383653"},"outputs":[{"output_type":"stream","name":"stdout","text":["RuleUnit Review Result: 379.8650100000001\n"]}],"source":["Rule_Review_Result = my_RuleUnit.Minimum_amount_of_rebar_required_within_concrete_tensile_area(fOAsmin,fIAct,fIfs,fIfct,fIkc,fIfn,fINu,fIhstar,fIk1,fINcr,fIk,fIh,fIflawid,fIuserdefined)\n","# 해당건설기준 항목 의 값은?\n","\n","print(\"RuleUnit Review Result: {}\".format(Rule_Review_Result))"]},{"cell_type":"markdown","metadata":{"id":"7TnAwYSbiqpE"},"source":["<br><br>\n","아래의 코드를 통해, 룰 유닛의 content(건설기준 항목의 실제 내용)의 markdown 렌더링 결과를 확인할 수 있습니다."]},{"cell_type":"code","execution_count":7,"metadata":{"id":"3BSi3TyUiu6H","colab":{"base_uri":"https://localhost:8080/","height":17},"executionInfo":{"status":"ok","timestamp":1701252343786,"user_tz":-540,"elapsed":7,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}},"outputId":"91854770-a55e-4f4c-810b-af486053a75c"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Markdown object>"],"text/markdown":"\n\n\n    "},"metadata":{}}],"source":["my_RuleUnit.render_markdown()"]}],"metadata":{"colab":{"provenance":[{"file_id":"1SJuH3C7x3JKgqjMSKmuKhe7WUlH9nN0r","timestamp":1691543669780},{"file_id":"1T-kPFUJTy0JUtisu6LLIsNK6yjl9AE5z","timestamp":1689928261860},{"file_id":"1FKcEkmC8sjFendaUJI5nY9FQVPYBFWnt","timestamp":1689903322566},{"file_id":"1p6jLaorqf3Zl1Og2wHOctERtkgjwBjrU","timestamp":1689753625918},{"file_id":"15jZPegTcUqCXxee33FxMzfCjeMAwcNRA","timestamp":1688037542443}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}