{"cells":[{"cell_type":"markdown","metadata":{"id":"-0-qnEblh80w"},"source":["# Rule Unit 작성 예시\n","\n","본 문서는 1차년도 6월에 개발된 RuleUnit 클래스를 활용하여 룰 유닛을 작성하고 실행하는 과정을 설명합니다."]},{"cell_type":"markdown","metadata":{"id":"AR83L9Pxh_6F"},"source":["⚠︎ 주의사항: 코드를 변경하며 작업할 때는, 사본을 생성한 후 작업해주십시오."]},{"cell_type":"markdown","metadata":{"id":"33RPd0N_iCuY"},"source":["## 룰 유닛 작성하기\n","이 부분에서는 기존의 IFC 파일에 종속적이었던 실행 흐름에서 벗어나, 새로이 정의한 RuleUnit 구조에 기반하여 룰에 포함된 항목을 작성하는 방법을 다룹니다.<br><br>\n","본 예시에서는 KDS 24 14 21 4.6.5.1(5) 를 룰 유닛으로 작성합니다."]},{"cell_type":"markdown","metadata":{"id":"qL08gaStiE0L"},"source":["먼저, Rule 작성에 필요한 프로그램을 불러오기 위해 Github에서 아래의 주소가 가리키는 파일 모음을 불러옵니다. (Github Repository를 clone합니다.)"]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5AR_68PDk-KZ","executionInfo":{"status":"ok","timestamp":1700128426921,"user_tz":-540,"elapsed":842,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}},"outputId":"0689e988-8230-45ee-cf05-e9902d12bd20"},"outputs":[{"output_type":"stream","name":"stdout","text":["Cloning into 'tomok'...\n","remote: Enumerating objects: 175, done.\u001b[K\n","remote: Counting objects: 100% (117/117), done.\u001b[K\n","remote: Compressing objects: 100% (86/86), done.\u001b[K\n","remote: Total 175 (delta 54), reused 85 (delta 31), pack-reused 58\u001b[K\n","Receiving objects: 100% (175/175), 451.83 KiB | 5.72 MiB/s, done.\n","Resolving deltas: 100% (62/62), done.\n"]}],"source":["!git clone https://github.com/KU-HIAI/tomok.git"]},{"cell_type":"markdown","metadata":{"id":"poob594xiNFU"},"source":["필요한 파일을 불러온 다음에는 현재 작업 경로를 tomok의 파일이 있는 위치로 이동합니다.<br><br>\n","아래의 코드 블록을 실행하면, 작성자의 기본 작업 경로가 필요한 파일이 있는 위치로 이동됩니다."]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qyIxAqkriO26","executionInfo":{"status":"ok","timestamp":1700128426921,"user_tz":-540,"elapsed":3,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}},"outputId":"8e84e2d3-1175-45a6-dd1b-c02715794b80"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/tomok\n"]}],"source":["cd tomok"]},{"cell_type":"markdown","metadata":{"id":"8lGDCXNZiej5"},"source":["## 룰 유닛 작성해보기\n","지금까지의 내용을 바탕으로 룰 유닛을 작성해봅시다.\n","\n","새로운 룰 유닛을 작성하기 위해서는, 아래 코드 블럭에서 클래스 이름, 메타정보에 해당하는 변수, 실행 함수의 이름과 내용을 수정하면 됩니다."]},{"cell_type":"code","execution_count":3,"metadata":{"id":"rfDi2pQqicoD","executionInfo":{"status":"ok","timestamp":1700128426921,"user_tz":-540,"elapsed":2,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}}},"outputs":[],"source":["import math\n","from typing import List\n","\n","import tomok\n","\n","# 작성하는 룰에 맞게 클래스 이름 수정 (KDS241421_04010203_04)\n","class KDS241421_04010203_04 (tomok.RuleUnit):\n","\n","    # 아래 클래스 멤버 변수에 할당되는 값들을 작성하는 룰에 맞게 수정\n","    priority = 1   # 건설기준 우선순위\n","    author = 'Chanwoo Yang'  # 작성자명\n","    ref_code = 'KDS 24 14 21 4.1.2.3 (4)' # 건설기준문서\n","    ref_date = '2021-04-12'  # 디지털 건설문서 작성일\n","    doc_date = '2023-11-10'  # 건설기준문서->디지털 건설기준 변환 기준일\n","    title = '수직 스터럽 또는 경사 스터럽이 배치된 부재의 설계전단강도'    # 건설기준명\n","\n","    #\n","    description = \"\"\"\n","    콘크리트교 설계기준 (한계상태설계법)\n","    4. 설계\n","    4.1 극한한계상태\n","    4.1.2 전단\n","    4.1.2.3 전단보강철근이 배치된 부재\n","    (4)\n","    \"\"\"\n","    # https://dillinger.io/ 표와 이미지 랜더링 확인 사이트\n","    # 이미지 링크 변환 사이트 https://www.somanet.xyz/2017/06/blog-post_21.html\n","    # 건설기준문서내용(text)\n","    content = \"\"\"\n","    ####  4.1.2.3 전단보강철근이 배치된 부재\n","    \\n (4) 프리스트레스를 포함하여 축방향 압축력이 작용하고 있는 부재의 경우, 수직 스터럽 또는 경사 스터럽이 배치된 부재의 설계전단강도 $V_{sd}$는 각각 식 (4.1-16) 또는 식 (4.1-19)로 산정하여야 하며, 이는 식 (4.1-22)로 계산한최대설계전단강도 $V_{d,max,com}$보다 크지 않아야 한다.\n","    \\n $$ V_{d,max,com} = \\\\alpha_{cw} V_{d,max} \\quad (4.1-22)$$\n","    \\n 여기서 $V_{d,max}$는 각각 식 (4.1.17)과 식 (4.1.20)로 구하고, $\\\\alpha_{cw}$값은 다음과 같다.\n","    \\n $$\\\\alpha_{cw} = (1 + f_{n} / \\\\phi_{c} f_{ck}) : 0  < f_{n} \\\\leq 0.25\\\\phi_{c}f_{ck} \\quad (4.1-23a) $$\n","    \\n $$\\\\alpha_{cw} = 1.25 : 0.25\\\\phi_{c}f_{ck} < f_{n} < 0.5\\\\phi_{c}f_{ck} \\quad (4.1-23b)$$\n","    \\n $$\\\\alpha_{cw} = 2.5(1 - f_{n} / \\\\phi_{c} f_{ck}) : 0.5\\\\phi_{c}f_{ck}  < f_{n} \\\\leq 1.0\\\\phi_{c}f_{ck} \\quad (4.1-23c)$$\n","    \\n 여기서, $f_{n}$ = 계수하중에 의해 단면에 유발된 평균 압축 응력\n","\n","    \"\"\"\n","    # 플로우차트(mermaid)\n","    flowchart = \"\"\"\n","    flowchart TD\n","    subgraph Python_Class\n","    A[\"계산한 최대 설계전단강도\"];\n","    B[\"KDS 24 14 21 4.1.2.3 (4)\"];\n","    A ~~~ B\n","    end\n","\n","\t\tsubgraph Variable_def;\n","\t\tVarOut1[/출력변수: 축방향 압축력이 작용하는 경우의 최대설계전단강도/];\n","\t\tVarIn1[/입력변수: 수직 스터럽 또는 경사 스터럽이 배치된 부재의설계전단강도/];\n","\t\tVarIn2[/입력변수: 축력이 작용하지 않을 경우의 최대설계전단강도/];\n","\t\tVarIn3[/입력변수: 계수하중에 의해 단면에 유발된 평균압축응력/];\n","\t\tVarIn4[/입력변수: 콘크리트의 재료저항계수/];\n","\t\tVarIn5[/입력변수: 28일 콘크리트 공시체의 기준압축강도/];\n","\t\tVarIn6[/입력변수: αcw/];\n","\t\tVarOut1 ~~~ VarIn1 & VarIn2 & VarIn3\n","    \t\tVarIn2 ~~~ VarIn4 & VarIn5 & VarIn6\n","\n","\n","\t\tend\n","\t\tPython_Class ~~~ Variable_def;\n","\t\tVariable_def--->C--->F\n","\t\tVariable_def--->D--->G\n","\t\tVariable_def--->E--->H\n","\t\tF & G & H--->I--->J--->K\n","\t\tC{\"<img src='https://latex.codecogs.com/svg.image?&space;0<f_{n}\\leq&space;0.25\\phi&space;_cf_{ck};'>---------------------------------\"}\n","\t\tD{\"<img src='https://latex.codecogs.com/svg.image?0.25\\phi&space;_cf_{ck}<f_n\\leq&space;0.5\\phi&space;_{c}f_{ck}'>---------------------------------\"}\n","\t\tE{\"<img src='https://latex.codecogs.com/svg.image?0.5\\phi&space;_{c}f_{ck}<f_{n}\\leq&space;1.0\\phi&space;_cf_{ck}'>------------------------------\"}\n","\t\tF[\"<img src='https://latex.codecogs.com/svg.image?\\alpha_{cw}=(1&plus;f_n/\\phi&space;_cf_{ck})'>---------------------------------\"]\n","\t\tG[\"<img src='https://latex.codecogs.com/svg.image?\\alpha_{cw}=1.25'>---------------------------------\"]\n","\t\tH[\"<img src='https://latex.codecogs.com/svg.image?\\alpha_{cw}=2.5(1-f_n/\\phi&space;_cf_{ck})'>---------------------------------\"]\n","\t\tI[\"<img src='https://latex.codecogs.com/svg.image?V_{d,max,com}=\\alpha&space;_{cw}V_{d,max}'>---------------------------------\"]\n","\t\tJ[\"<img src='https://latex.codecogs.com/svg.image?V_{sd}\\leq&space;V_{d,max,com}'>---------------------------------\"]\n","\t\tK([\"Pass or Fail\"])\n","    \"\"\"\n","\n","    # 작성하는 룰에 맞게 함수 이름과 내용을 수정,\n","    @tomok.rule_method\n","    def Design_shear_strength_of_members_with_vertical_stirrups_or_inclined_stirrups(fIVsd,fOVdmaxcom,fIalphacw,fIVdmax,fIfn,fIphic,fIfck) -> bool:\n","        \"\"\"수직 스터럽 또는 경사 스터럽이 배치된 부재의 설계전단강도\n","\n","        Args:\n","             fIVsd (float): 수직 스터럽 또는 경사 스터럽이 배치된 부재의 설계전단강도\n","             fOVdmaxcom (float): 축방향 압축력이 작용할 경우의 최대설계전단강도\n","             fIalphacw (float): 축방향 압축력에 의한 강도계수\n","             fIVdmax (float): 축력이 작용하지 않을 경우의 최대설계전단강도\n","             fIfn (float):  계수하중에 의해 단면에 유발된 평균압축응력\n","             fIphic (float): 콘크리트의 재료저항계수\n","             fIfck (float): 28일 콘크리트 공시체의 기준압축강도\n","\n","\n","\n","        Returns:\n","            bool: 콘크리트교 설계기준 (한계상태설계법) 4.1.2.3 전단보강철근이 배치된 부재 (4)의 통과 여부\n","        \"\"\"\n","\n","        if 0 < fIfn <= 0.25 * fIphic * fIfck:\n","          fIalphacw = 1 + fIfn / ( fIphic * fIfck )\n","        elif 0.25 * fIphic * fIfck < fIfn <= 0.5 * fIphic * fIfck:\n","          fIalphacw = 1.25\n","        elif 0.5 * fIphic * fIfck < fIfn <= 1.0 * fIphic * fIfck:\n","          fIalphacw = 2.5 * ( 1- fIfn/( fIphic * fIfck ) )\n","\n","        fOVdmaxcom = fIalphacw * fIVdmax\n","        if fIVsd <= fOVdmaxcom:\n","          return fOVdmaxcom, \"Pass\"\n","        else:\n","          return fOVdmaxcom, \"Fail\""]},{"cell_type":"markdown","source":[],"metadata":{"id":"yVE_Q1rB2KwO"}},{"cell_type":"markdown","metadata":{"id":"9oy-Y8abiiIu"},"source":["작성한 룰 유닛은 아래의 코드 블럭과 같이 생성하여, 작성자가 임의로 검증을 수행할 수 있습니다."]},{"cell_type":"code","execution_count":4,"metadata":{"id":"D1Pm_gEtikei","executionInfo":{"status":"ok","timestamp":1700128426922,"user_tz":-540,"elapsed":3,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}}},"outputs":[],"source":["my_RuleUnit = KDS241421_04010203_04()"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"HVyDu2z7imJC","executionInfo":{"status":"ok","timestamp":1700128427223,"user_tz":-540,"elapsed":303,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}}},"outputs":[],"source":["fIVsd = 100\n","fOVdmaxcom = None\n","fIalphacw = None\n","fIVdmax = 200\n","fIfn = 3\n","fIphic = 0.85\n","fIfck = 21"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"UDa_8Sh_iraQ","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1700128427223,"user_tz":-540,"elapsed":9,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}},"outputId":"85222216-d59d-4360-f8dd-665646db4d3b"},"outputs":[{"output_type":"stream","name":"stdout","text":["RuleUnit Review Result: (233.61344537815128, 'Pass')\n"]}],"source":["Rule_Review_Result = my_RuleUnit.Design_shear_strength_of_members_with_vertical_stirrups_or_inclined_stirrups(fIVsd,fOVdmaxcom,fIalphacw,fIVdmax,fIfn,fIphic,fIfck)\n","# 해당건설기준 항목 를 통과하는가?\n","\n","print(\"RuleUnit Review Result: {}\".format(Rule_Review_Result))"]},{"cell_type":"markdown","metadata":{"id":"7TnAwYSbiqpE"},"source":["<br><br>\n","아래의 코드를 통해, 룰 유닛의 content(건설기준 항목의 실제 내용)의 markdown 렌더링 결과를 확인할 수 있습니다."]},{"cell_type":"code","execution_count":7,"metadata":{"id":"3BSi3TyUiu6H","colab":{"base_uri":"https://localhost:8080/","height":253},"executionInfo":{"status":"ok","timestamp":1700128427224,"user_tz":-540,"elapsed":10,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}},"outputId":"344c7647-e60c-419f-d983-871248ee7e1c"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Markdown object>"],"text/markdown":"\n    ####  4.1.2.3 전단보강철근이 배치된 부재\n    \n (4) 프리스트레스를 포함하여 축방향 압축력이 작용하고 있는 부재의 경우, 수직 스터럽 또는 경사 스터럽이 배치된 부재의 설계전단강도 $V_{sd}$는 각각 식 (4.1-16) 또는 식 (4.1-19)로 산정하여야 하며, 이는 식 (4.1-22)로 계산한최대설계전단강도 $V_{d,max,com}$보다 크지 않아야 한다.\n    \n $$ V_{d,max,com} = \\alpha_{cw} V_{d,max} \\quad (4.1-22)$$\n    \n 여기서 $V_{d,max}$는 각각 식 (4.1.17)과 식 (4.1.20)로 구하고, $\\alpha_{cw}$값은 다음과 같다.\n    \n $$\\alpha_{cw} = (1 + f_{n} / \\phi_{c} f_{ck}) : 0  < f_{n} \\leq 0.25\\phi_{c}f_{ck} \\quad (4.1-23a) $$\n    \n $$\\alpha_{cw} = 1.25 : 0.25\\phi_{c}f_{ck} < f_{n} < 0.5\\phi_{c}f_{ck} \\quad (4.1-23b)$$\n    \n $$\\alpha_{cw} = 2.5(1 - f_{n} / \\phi_{c} f_{ck}) : 0.5\\phi_{c}f_{ck}  < f_{n} \\leq 1.0\\phi_{c}f_{ck} \\quad (4.1-23c)$$\n    \n 여기서, $f_{n}$ = 계수하중에 의해 단면에 유발된 평균 압축 응력\n\n    "},"metadata":{}}],"source":["my_RuleUnit.render_markdown()"]}],"metadata":{"colab":{"provenance":[{"file_id":"1SJuH3C7x3JKgqjMSKmuKhe7WUlH9nN0r","timestamp":1691543669780},{"file_id":"1T-kPFUJTy0JUtisu6LLIsNK6yjl9AE5z","timestamp":1689928261860},{"file_id":"1FKcEkmC8sjFendaUJI5nY9FQVPYBFWnt","timestamp":1689903322566},{"file_id":"1p6jLaorqf3Zl1Og2wHOctERtkgjwBjrU","timestamp":1689753625918},{"file_id":"15jZPegTcUqCXxee33FxMzfCjeMAwcNRA","timestamp":1688037542443}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}