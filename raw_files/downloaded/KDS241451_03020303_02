{"cells":[{"cell_type":"markdown","source":[],"metadata":{"id":"B_bZsZrT1Nxk"}},{"cell_type":"markdown","metadata":{"id":"-0-qnEblh80w"},"source":["# Rule Unit 작성 예시\n","\n","본 문서는 1차년도 6월에 개발된 RuleUnit 클래스를 활용하여 룰 유닛을 작성하고 실행하는 과정을 설명합니다."]},{"cell_type":"markdown","metadata":{"id":"AR83L9Pxh_6F"},"source":["⚠︎ 주의사항: 코드를 변경하며 작업할 때는, 사본을 생성한 후 작업해주십시오."]},{"cell_type":"markdown","metadata":{"id":"33RPd0N_iCuY"},"source":["## 룰 유닛 작성하기\n","이 부분에서는 기존의 IFC 파일에 종속적이었던 실행 흐름에서 벗어나, 새로이 정의한 RuleUnit 구조에 기반하여 룰에 포함된 항목을 작성하는 방법을 다룹니다.<br><br>\n","본 예시에서는 KDS 24 14 21 4.6.5.1(5) 를 룰 유닛으로 작성합니다."]},{"cell_type":"markdown","metadata":{"id":"qL08gaStiE0L"},"source":["먼저, Rule 작성에 필요한 프로그램을 불러오기 위해 Github에서 아래의 주소가 가리키는 파일 모음을 불러옵니다. (Github Repository를 clone합니다.)"]},{"cell_type":"code","execution_count":29,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5AR_68PDk-KZ","executionInfo":{"status":"ok","timestamp":1700293826867,"user_tz":-540,"elapsed":728,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}},"outputId":"69b8acc9-dea8-4939-bbcf-bcf4fd21f9d1"},"outputs":[{"output_type":"stream","name":"stdout","text":["Cloning into 'tomok'...\n","remote: Enumerating objects: 175, done.\u001b[K\n","remote: Counting objects:   0% (1/117)\u001b[K\rremote: Counting objects:   1% (2/117)\u001b[K\rremote: Counting objects:   2% (3/117)\u001b[K\rremote: Counting objects:   3% (4/117)\u001b[K\rremote: Counting objects:   4% (5/117)\u001b[K\rremote: Counting objects:   5% (6/117)\u001b[K\rremote: Counting objects:   6% (8/117)\u001b[K\rremote: Counting objects:   7% (9/117)\u001b[K\rremote: Counting objects:   8% (10/117)\u001b[K\rremote: Counting objects:   9% (11/117)\u001b[K\rremote: Counting objects:  10% (12/117)\u001b[K\rremote: Counting objects:  11% (13/117)\u001b[K\rremote: Counting objects:  12% (15/117)\u001b[K\rremote: Counting objects:  13% (16/117)\u001b[K\rremote: Counting objects:  14% (17/117)\u001b[K\rremote: Counting objects:  15% (18/117)\u001b[K\rremote: Counting objects:  16% (19/117)\u001b[K\rremote: Counting objects:  17% (20/117)\u001b[K\rremote: Counting objects:  18% (22/117)\u001b[K\rremote: Counting objects:  19% (23/117)\u001b[K\rremote: Counting objects:  20% (24/117)\u001b[K\rremote: Counting objects:  21% (25/117)\u001b[K\rremote: Counting objects:  22% (26/117)\u001b[K\rremote: Counting objects:  23% (27/117)\u001b[K\rremote: Counting objects:  24% (29/117)\u001b[K\rremote: Counting objects:  25% (30/117)\u001b[K\rremote: Counting objects:  26% (31/117)\u001b[K\rremote: Counting objects:  27% (32/117)\u001b[K\rremote: Counting objects:  28% (33/117)\u001b[K\rremote: Counting objects:  29% (34/117)\u001b[K\rremote: Counting objects:  30% (36/117)\u001b[K\rremote: Counting objects:  31% (37/117)\u001b[K\rremote: Counting objects:  32% (38/117)\u001b[K\rremote: Counting objects:  33% (39/117)\u001b[K\rremote: Counting objects:  34% (40/117)\u001b[K\rremote: Counting objects:  35% (41/117)\u001b[K\rremote: Counting objects:  36% (43/117)\u001b[K\rremote: Counting objects:  37% (44/117)\u001b[K\rremote: Counting objects:  38% (45/117)\u001b[K\rremote: Counting objects:  39% (46/117)\u001b[K\rremote: Counting objects:  40% (47/117)\u001b[K\rremote: Counting objects:  41% (48/117)\u001b[K\rremote: Counting objects:  42% (50/117)\u001b[K\rremote: Counting objects:  43% (51/117)\u001b[K\rremote: Counting objects:  44% (52/117)\u001b[K\rremote: Counting objects:  45% (53/117)\u001b[K\rremote: Counting objects:  46% (54/117)\u001b[K\rremote: Counting objects:  47% (55/117)\u001b[K\rremote: Counting objects:  48% (57/117)\u001b[K\rremote: Counting objects:  49% (58/117)\u001b[K\rremote: Counting objects:  50% (59/117)\u001b[K\rremote: Counting objects:  51% (60/117)\u001b[K\rremote: Counting objects:  52% (61/117)\u001b[K\rremote: Counting objects:  53% (63/117)\u001b[K\rremote: Counting objects:  54% (64/117)\u001b[K\rremote: Counting objects:  55% (65/117)\u001b[K\rremote: Counting objects:  56% (66/117)\u001b[K\rremote: Counting objects:  57% (67/117)\u001b[K\rremote: Counting objects:  58% (68/117)\u001b[K\rremote: Counting objects:  59% (70/117)\u001b[K\rremote: Counting objects:  60% (71/117)\u001b[K\rremote: Counting objects:  61% (72/117)\u001b[K\rremote: Counting objects:  62% (73/117)\u001b[K\rremote: Counting objects:  63% (74/117)\u001b[K\rremote: Counting objects:  64% (75/117)\u001b[K\rremote: Counting objects:  65% (77/117)\u001b[K\rremote: Counting objects:  66% (78/117)\u001b[K\rremote: Counting objects:  67% (79/117)\u001b[K\rremote: Counting objects:  68% (80/117)\u001b[K\rremote: Counting objects:  69% (81/117)\u001b[K\rremote: Counting objects:  70% (82/117)\u001b[K\rremote: Counting objects:  71% (84/117)\u001b[K\rremote: Counting objects:  72% (85/117)\u001b[K\rremote: Counting objects:  73% (86/117)\u001b[K\rremote: Counting objects:  74% (87/117)\u001b[K\rremote: Counting objects:  75% (88/117)\u001b[K\rremote: Counting objects:  76% (89/117)\u001b[K\rremote: Counting objects:  77% (91/117)\u001b[K\rremote: Counting objects:  78% (92/117)\u001b[K\rremote: Counting objects:  79% (93/117)\u001b[K\rremote: Counting objects:  80% (94/117)\u001b[K\rremote: Counting objects:  81% (95/117)\u001b[K\rremote: Counting objects:  82% (96/117)\u001b[K\rremote: Counting objects:  83% (98/117)\u001b[K\rremote: Counting objects:  84% (99/117)\u001b[K\rremote: Counting objects:  85% (100/117)\u001b[K\rremote: Counting objects:  86% (101/117)\u001b[K\rremote: Counting objects:  87% (102/117)\u001b[K\rremote: Counting objects:  88% (103/117)\u001b[K\rremote: Counting objects:  89% (105/117)\u001b[K\rremote: Counting objects:  90% (106/117)\u001b[K\rremote: Counting objects:  91% (107/117)\u001b[K\rremote: Counting objects:  92% (108/117)\u001b[K\rremote: Counting objects:  93% (109/117)\u001b[K\rremote: Counting objects:  94% (110/117)\u001b[K\rremote: Counting objects:  95% (112/117)\u001b[K\rremote: Counting objects:  96% (113/117)\u001b[K\rremote: Counting objects:  97% (114/117)\u001b[K\rremote: Counting objects:  98% (115/117)\u001b[K\rremote: Counting objects:  99% (116/117)\u001b[K\rremote: Counting objects: 100% (117/117)\u001b[K\rremote: Counting objects: 100% (117/117), done.\u001b[K\n","remote: Compressing objects: 100% (86/86), done.\u001b[K\n","remote: Total 175 (delta 54), reused 85 (delta 31), pack-reused 58\u001b[K\n","Receiving objects: 100% (175/175), 451.83 KiB | 6.85 MiB/s, done.\n","Resolving deltas: 100% (62/62), done.\n"]}],"source":["!git clone https://github.com/KU-HIAI/tomok.git"]},{"cell_type":"markdown","metadata":{"id":"poob594xiNFU"},"source":["필요한 파일을 불러온 다음에는 현재 작업 경로를 tomok의 파일이 있는 위치로 이동합니다.<br><br>\n","아래의 코드 블록을 실행하면, 작성자의 기본 작업 경로가 필요한 파일이 있는 위치로 이동됩니다."]},{"cell_type":"code","execution_count":30,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qyIxAqkriO26","executionInfo":{"status":"ok","timestamp":1700293826867,"user_tz":-540,"elapsed":6,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}},"outputId":"1401e809-a3ea-41e8-ea74-0e98cb020b6e"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/tomok/tomok/tomok/tomok/tomok\n"]}],"source":["cd tomok"]},{"cell_type":"markdown","metadata":{"id":"8lGDCXNZiej5"},"source":["## 룰 유닛 작성해보기\n","지금까지의 내용을 바탕으로 룰 유닛을 작성해봅시다.\n","\n","새로운 룰 유닛을 작성하기 위해서는, 아래 코드 블럭에서 클래스 이름, 메타정보에 해당하는 변수, 실행 함수의 이름과 내용을 수정하면 됩니다."]},{"cell_type":"code","execution_count":31,"metadata":{"id":"rfDi2pQqicoD","executionInfo":{"status":"ok","timestamp":1700293826867,"user_tz":-540,"elapsed":5,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}}},"outputs":[],"source":["import math\n","from typing import List\n","\n","import tomok\n","\n","# 작성하는 룰에 맞게 클래스 이름 수정 (KDS241451_03020303_02)\n","class KDS241451_03020303_02 (tomok.RuleUnit):\n","\n","    # 아래 클래스 멤버 변수에 할당되는 값들을 작성하는 룰에 맞게 수정\n","    priority = 1   # 건설기준 우선순위\n","    author = 'Jiwoo Won'  # 작성자명\n","    ref_code = 'KDS 24 14 51 3.2.3.3 (2)' # 건설기준문서\n","    ref_date = '2021-04-12'  # 디지털 건설문서 작성일\n","    doc_date = '2023-11-10'  # 건설기준문서->디지털 건설기준 변환 기준일\n","    title = '설계저항력'    # 건설기준명\n","\n","    #\n","    description = \"\"\"\n","    교량 하부구조 설계기준 (한계상태설계법)\n","    3.2 확대기초\n","    3.2.3 극한한계상태의 지지력\n","    3.2.3.3 활동 파괴\n","    (2)\n","    \"\"\"\n","    # https://dillinger.io/ 표와 이미지 랜더링 확인 사이트\n","    # 이미지 링크 변환 사이트 https://www.somanet.xyz/2017/06/blog-post_21.html\n","    # 건설기준문서내용(text)\n","    content = \"\"\"\n","\n","    \"\"\"\n","    # 플로우차트(mermaid)\n","    flowchart = \"\"\"\n","    flowchart TD\n","    subgraph Python_Class\n","    A[활동파괴];\n","    B[\"KDS 24 14 51 3.2.3.3 (2)\"];\n","    A ~~~ B\n","    end\n","\n","      subgraph Variable_def;\n","\t\t\tVarOut1[/출력변수: 설계저항력/];\n","\t\t\tVarOut2[/출력변수: 설계저항력/];\n","\t\t\tVarIn1[/입력변수: 흙과 기초 사이의 전단저항에 대한 저항계수/];\n","\t\t\tVarIn2[/입력변수: 흙과 기초 사이의 공칭전단/];\n","\t\t\tVarIn3[/입력변수: 수동저항에 대한 저항계수/];\n","\t\t\tVarIn4[/입력변수: 구조무의 총 설계 수명에 대한 흙의 공칭수동저항력/];\n","\t\t\tVarIn5[/입력변수: 흙의 내부마찰각/];\n","\t\t\tVarIn6[/입력변수: 총연직력/];\n","\n","\t\t\tVarOut1 ~~~ VarOut2\n","\t\t\tVarIn1 ~~~ VarIn2 ~~~ VarIn3\n","\t\t\tVarIn4 ~~~ VarIn5 ~~~ VarIn6\n","\n","      end\n","      Python_Class ~~~ Variable_def;\n","      Variable_def\n","\n","\t\t\tC[기초 아래 흙이 사질토]\n","\t\t\tD[\"<img src='https://latex.codecogs.com/svg.image?&space;Q_{R}=\\phi&space;Q_{n}=\\phi&space;_{\\tau}Q_{\\tau}&plus;\\phi&space;_{ep}Q_{ep}'>---------------------------------\"]\n","\t\t\tE[\"<img src='https://latex.codecogs.com/svg.image?Q_{\\tau}=Vtan\\delta'>---------------------------------\"]\n","\t\t\tF[\"<img src='https://latex.codecogs.com/svg.image?tan\\delta=tan\\phi&space;_{f}'>---------------------------------\"]\n","\t\t\tG[\"<img src='https://latex.codecogs.com/svg.image?tan\\delta=0.8tan\\phi&space;_{f}'>---------------------------------\"]\n","\t\t\tH[현장타설 콘크리트 기초]\n","\t\t\tI[프리캐스트 콘크리트 기초]\n","\t\t\tJ([활동파괴에 대한 설계저항력])\n","\n","\t\t\tVariable_def ---> C ---> H & I\n","\t\t\tH ---> F\n","\t\t\tI ---> G\n","\t\t\tF & G ---> E\n","\t\t\tE ---> D ---> J\n","    \"\"\"\n","\n","    # 작성하는 룰에 맞게 함수 이름과 내용을 수정,\n","    @tomok.rule_method\n","    def Design_Resistance(fICoeres,fISQtau,fIResman,fIResstr,fIAngsoi,fIV,fIuserdefined) -> float:\n","        \"\"\"설계저항력\n","        Args:\n","            fOQr (float): 설계저항력\n","            fICoeres (float): 흙과 기초 사이의 전단저항에 대한 저항계수\n","            fISQtau (float): 흙과 기초 사이의 공칭 전단저항력\n","            fIResman (float): 수동저항에 대한 저항계수\n","            fIResstr (float): 구조물의 총 설계 수명에 대한 흙의 공칭수동저항력\n","            fOQresis (float): 설계저항력\n","            fIAngsoi (float): 흙의 내부마찰각\n","            fIV (float): 총연직력\n","            fIuserdefined (float): 사용자 선택\n","\n","\n","        Returns:\n","            float: 교량 하부구조 설계기준 (한계상태설계법) 3.2.3.3 (2)의 설계저항력 값\n","        \"\"\"\n","        import math\n","        if  fIuserdefined == 1: #기초 아래 흙이 사질토, 현장타설 콘크리트 기초\n","          fISQtau = fIV * math.tan(math.radians(fIAngsoi))\n","          fOQr = fICoeres * fISQtau + fIResman * fIResstr\n","          return fOQr\n","        elif  fIuserdefined == 2: #기초 아래 흙이 사질토, 프리캐스트 콘크리트 기초\n","          fISQtau = fIV * 0.8 * math.tan(math.radians(fIAngsoi))\n","          fOQr = fICoeres * fISQtau + fIResman * fIResstr\n","          return fOQr\n","        elif  fIuserdefined == 3: #기초 아래 흙이 사질토가 아닌 경우\n","          fOQr = fICoeres * fISQtau + fIResman * fIResstr\n","          return fOQr\n","\n"]},{"cell_type":"markdown","source":[],"metadata":{"id":"yVE_Q1rB2KwO"}},{"cell_type":"markdown","metadata":{"id":"9oy-Y8abiiIu"},"source":["작성한 룰 유닛은 아래의 코드 블럭과 같이 생성하여, 작성자가 임의로 검증을 수행할 수 있습니다."]},{"cell_type":"code","execution_count":32,"metadata":{"id":"D1Pm_gEtikei","executionInfo":{"status":"ok","timestamp":1700293826867,"user_tz":-540,"elapsed":5,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}}},"outputs":[],"source":["my_RuleUnit = KDS241451_03020303_02()"]},{"cell_type":"code","execution_count":33,"metadata":{"id":"HVyDu2z7imJC","executionInfo":{"status":"ok","timestamp":1700293826867,"user_tz":-540,"elapsed":5,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}}},"outputs":[],"source":["fICoeres=1.3\n","fISQtau=10\n","fIResman=1.3\n","fIResstr=5\n","fIAngsoi=25\n","fIV=5\n","fIuserdefined=2\n","fOQr = None"]},{"cell_type":"code","execution_count":34,"metadata":{"id":"UDa_8Sh_iraQ","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1700293826867,"user_tz":-540,"elapsed":4,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}},"outputId":"fed915a0-7789-4a64-d26f-74c3dfc04fbc"},"outputs":[{"output_type":"stream","name":"stdout","text":["RuleUnit Review Result: 8.924799822405992\n"]}],"source":["Rule_Review_Result = my_RuleUnit.Design_Resistance(fICoeres,fISQtau,fIResman,fIResstr,fIAngsoi,fIV,fIuserdefined)\n","#설계저항력\n","\n","print(\"RuleUnit Review Result: {}\".format(Rule_Review_Result))"]},{"cell_type":"markdown","metadata":{"id":"7TnAwYSbiqpE"},"source":["<br><br>\n","아래의 코드를 통해, 룰 유닛의 content(건설기준 항목의 실제 내용)의 markdown 렌더링 결과를 확인할 수 있습니다."]},{"cell_type":"code","execution_count":35,"metadata":{"id":"3BSi3TyUiu6H","colab":{"base_uri":"https://localhost:8080/","height":17},"executionInfo":{"status":"ok","timestamp":1700293826867,"user_tz":-540,"elapsed":3,"user":{"displayName":"digitalcodes KICT","userId":"11324252449574396480"}},"outputId":"98af3aef-cb67-4f19-af23-1318cef3d4fb"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Markdown object>"],"text/markdown":"\n\n    "},"metadata":{}}],"source":["my_RuleUnit.render_markdown()"]}],"metadata":{"colab":{"provenance":[{"file_id":"1SJuH3C7x3JKgqjMSKmuKhe7WUlH9nN0r","timestamp":1691543669780},{"file_id":"1T-kPFUJTy0JUtisu6LLIsNK6yjl9AE5z","timestamp":1689928261860},{"file_id":"1FKcEkmC8sjFendaUJI5nY9FQVPYBFWnt","timestamp":1689903322566},{"file_id":"1p6jLaorqf3Zl1Og2wHOctERtkgjwBjrU","timestamp":1689753625918},{"file_id":"15jZPegTcUqCXxee33FxMzfCjeMAwcNRA","timestamp":1688037542443}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}